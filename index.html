<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flash Tattoo Studio</title>

<link href="https://fonts.googleapis.com/css2?family=Anton&family=Cinzel&family=Great+Vibes&family=Permanent+Marker&family=Playfair+Display&family=Special+Elite&display=swap" rel="stylesheet">

<style>
body{
margin:0;
background:#000;
color:white;
font-family:Arial;
}

/* TOPO */
header{
text-align:center;
padding:15px;
}

button{
background:white;
color:#1976d2;
border:none;
padding:8px 14px;
margin:5px;
border-radius:20px;
font-weight:bold;
}

/* CAT√ÅLOGO */
#catalog{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(85px,1fr));
gap:10px;
padding:10px;
max-width:900px;
margin:auto;
}

#catalog img{
background:white;
padding:6px;
border-radius:12px;
width:100%;
}

/* PAINEL TEXTO */
.panel{
background:#111;
margin:20px auto;
padding:15px;
border-radius:15px;
max-width:900px;
}

.panel input,.panel select{
padding:6px;
border-radius:8px;
border:none;
margin:4px;
}

.controls{
display:grid;
grid-template-columns:1fr 1fr;
gap:10px;
margin-top:10px;
}

/* FOLHA */
.sheetWrapper{
display:flex;
justify-content:center;
}

.sheet{
width:95%;
max-width:794px;
aspect-ratio:794/1123;
background:white;
position:relative;
border-radius:20px;
margin:20px 0;
}

.item{position:absolute;text-align:center;}
.item img{width:100%;}

.textItem{
position:absolute;
white-space:nowrap;
color:black;
}

.textBtns{
position:absolute;
bottom:-25px;
}
.textBtns button{
font-size:11px;
padding:2px 5px;
margin:1px;
border-radius:6px;
}

/* IMPRESS√ÉO A4 */
@media print{
body{background:white;}
.panel,header,#catalog{display:none;}
.sheet{width:794px;height:1123px;}
}
</style>
</head>
<body>

<header>
<button onclick="newSheet()">Nova Folha</button>
<button onclick="organize()">Organizar</button>
<button onclick="window.print()">Imprimir</button>
</header>

<h2 style="text-align:center;">Cat√°logo</h2>
<div id="catalog"></div>

<div class="panel">
<h3>Texto para tatuagem</h3>
<input id="textInput" placeholder="Digite a frase">

<select id="fontSelect">
<option value="Anton">Bold Tattoo</option>
<option value="Cinzel">Romana</option>
<option value="Playfair Display">Elegante</option>
<option value="Permanent Marker">Rabiscado</option>
<option value="Great Vibes">Cursiva</option>
<option value="Special Elite">Old School</option>
</select>

<div class="controls">
<label>Tamanho <input type="range" id="sizeRange" min="14" max="80" value="30"></label>
<label>Espa√ßamento <input type="range" id="spacingRange" min="0" max="10" value="0"></label>
<label>Contorno <input type="range" id="outlineRange" min="0" max="5" value="0"></label>
<label>Sombra <input type="range" id="shadowRange" min="0" max="10" value="0"></label>
</div>

<button onclick="addTextToSheet()">Adicionar Texto na Folha</button>
</div>

<div id="sheets"></div>

<script>
const catalog=document.getElementById('catalog');
const sheets=document.getElementById('sheets');
let currentSheet;

/* CARREGAR FLASHES */
for(let i=1;i<=40;i++){
const img=document.createElement('img');
img.src='flashes/'+i+'.png';
img.onclick=()=>addFlash(img.src);
catalog.appendChild(img);
}

/* NOVA FOLHA */
function newSheet(){
const wrap=document.createElement('div');
wrap.className='sheetWrapper';

currentSheet=document.createElement('div');
currentSheet.className='sheet';
wrap.appendChild(currentSheet);

/* BOT√ÉO ESPELHAR */
const flipBtn=document.createElement('button');
flipBtn.textContent='‚áã';
flipBtn.style.position='absolute';
flipBtn.style.top='10px';
flipBtn.style.right='10px';
flipBtn.style.zIndex='10';
flipBtn.onclick=()=>{
currentSheet.classList.toggle('flipped');
};
wrap.appendChild(flipBtn);

sheets.appendChild(wrap);
}
newSheet();

/* CSS DO ESPELHO */
const style=document.createElement('style');
style.innerHTML=`.flipped{transform:scaleX(-1);} `;
document.head.appendChild(style);

/* POSI√á√ÉO AUTOM√ÅTICA */
function getNextPosition(){
const items=currentSheet.querySelectorAll('.item');
const cols=4,margin=10;
const w=(currentSheet.clientWidth-margin*(cols+1))/cols;
let i=items.length;
return{ x:margin+(i%cols)*(w+margin), y:margin+Math.floor(i/cols)*(w+margin)};
}

/* FLASH */
function addFlash(src){
const pos=getNextPosition();
const div=document.createElement('div');
div.className='item';
div.style.left=pos.x+'px';
div.style.top=pos.y+'px';
div.style.width='120px';
div.innerHTML=`<img src="${src}"><br>
<button onclick="resize(this,10)">+</button>
<button onclick="resize(this,-10)">-</button>
<button onclick="this.parentElement.remove()">X</button>`;
makeDraggable(div);
currentSheet.appendChild(div);
}

function resize(btn,val){
const p=btn.parentElement;
p.style.width=(p.offsetWidth+val)+'px';
}

/* ORGANIZAR */
function organize(){
const items=currentSheet.querySelectorAll('.item');
items.forEach((it,i)=>{
const pos=getNextPosition(i);
it.style.left=pos.x+'px';
it.style.top=pos.y+'px';
});
}

/* TEXTO */
function addTextToSheet(){
const text=document.getElementById('textInput').value;
if(!text)return;
const div=document.createElement('div');
div.className='textItem';
div.dataset.text=text;
div.style.left='120px';
div.style.top='200px';
updateText(div);

const btns=document.createElement('div');
btns.className='textBtns';
btns.innerHTML=`<button onclick="this.parentElement.parentElement.remove()">üóë</button>`;
div.appendChild(btns);

makeDraggable(div);
currentSheet.appendChild(div);
}

function updateText(div){
div.style.fontSize=sizeRange.value+'px';
div.style.fontFamily=fontSelect.value;
div.style.letterSpacing=spacingRange.value+'px';
div.style.webkitTextStroke=outlineRange.value+'px black';
div.style.textShadow=shadowRange.value>0?`2px 2px ${shadowRange.value}px rgba(0,0,0,0.5)`:'none';
div.textContent=div.dataset.text;
}

document.querySelectorAll('input,select').forEach(el=>{
el.oninput=()=>{
const t=currentSheet.querySelector('.textItem');
if(t)updateText(t);
}
});

/* ARRASTAR COM DEDO/MOUSE */
function makeDraggable(el){
let isDown=false, offsetX=0, offsetY=0;

el.addEventListener('mousedown',start);
el.addEventListener('touchstart',start);

function start(e){
isDown=true;
const rect=el.getBoundingClientRect();
offsetX=(e.touches?e.touches[0].clientX:e.clientX)-rect.left;
offsetY=(e.touches?e.touches[0].clientY:e.clientY)-rect.top;
document.addEventListener('mousemove',move);
document.addEventListener('touchmove',move);
document.addEventListener('mouseup',stop);
document.addEventListener('touchend',stop);
}

function move(e){
if(!isDown)return;
let x=(e.touches?e.touches[0].clientX:e.clientX)-offsetX;
let y=(e.touches?e.touches[0].clientY:e.clientY)-offsetY;
el.style.left=(x-currentSheet.getBoundingClientRect().left)+'px';
el.style.top=(y-currentSheet.getBoundingClientRect().top)+'px';
}

function stop(){
isDown=false;
document.removeEventListener('mousemove',move);
document.removeEventListener('touchmove',move);
}
}
</script>

</body>
</html>

